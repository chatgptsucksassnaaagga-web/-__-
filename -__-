-- =====================================
-- Krypth AJ â€“ Auto Joiner (FINAL FIXED)
-- =====================================

-- SERVICES
local Players = game:GetService("Players")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")
local Player = Players.LocalPlayer

local request =
    (syn and syn.request) or
    (http and http.request) or
    (fluxus and fluxus.request) or
    (krnl and krnl.request)

if not request then
    warn("HTTP not supported")
    return
end

-- =====================================
-- CONFIG (YOUR SERVER)
-- =====================================
local SERVER_URL = "https://acne-variations-flexibility-designs.trycloudflare.com/servers"
local AUTO_JOIN = false
local REFRESH_DELAY = 5

-- =====================================
-- GUI
-- =====================================
local gui = Instance.new("ScreenGui", Player:WaitForChild("PlayerGui"))
gui.Name = "KrypthAJ"

local main = Instance.new("Frame", gui)
main.Size = UDim2.new(0,277,0,374)
main.Position = UDim2.new(0.4,0,0.18,0)
main.BackgroundColor3 = Color3.fromRGB(27,27,27)
main.BackgroundTransparency = 0.03
Instance.new("UICorner", main).CornerRadius = UDim.new(0,2)
Instance.new("UIDragDetector", main)

local stroke = Instance.new("UIStroke", main)
stroke.Color = Color3.fromRGB(237,40,0)
stroke.Thickness = 2

-- TITLES
local title = Instance.new("TextLabel", main)
title.Text = "Krypth AJ"
title.Position = UDim2.new(0.02,0,-0.08,0)
title.Size = UDim2.new(0,120,0,30)
title.BackgroundTransparency = 1
title.TextColor3 = Color3.new(1,1,1)
title.TextSize = 22
title.Font = Enum.Font.GothamBold

local logsTxt = Instance.new("TextLabel", main)
logsTxt.Text = "LOGS"
logsTxt.Position = UDim2.new(0.55,0,-0.05,0)
logsTxt.Size = UDim2.new(0,80,0,25)
logsTxt.BackgroundTransparency = 1
logsTxt.TextColor3 = Color3.new(1,1,1)
logsTxt.TextSize = 20
logsTxt.Font = Enum.Font.GothamBold

-- LOG FRAME
local logs = Instance.new("ScrollingFrame", main)
logs.Position = UDim2.new(0.32,0,0,0)
logs.Size = UDim2.new(0,189,0,374)
logs.CanvasSize = UDim2.new()
logs.ScrollBarImageTransparency = 1
logs.BackgroundColor3 = Color3.fromRGB(0,0,0)
logs.BackgroundTransparency = 0.4

local layout = Instance.new("UIListLayout", logs)
layout.Padding = UDim.new(0,6)

-- BUTTON CREATOR
local function button(text,y)
    local b = Instance.new("TextButton", main)
    b.Size = UDim2.new(0,76,0,31)
    b.Position = UDim2.new(0.02,0,y,0)
    b.Text = text
    b.TextColor3 = Color3.new(1,1,1)
    b.TextSize = 20
    b.BackgroundColor3 = Color3.fromRGB(199,31,0)
    b.Font = Enum.Font.GothamBold
    Instance.new("UICorner", b)
    return b
end

local RefreshBtn = button("REFRESH",0.024)
local AutoBtn = button("AUTO JOIN",0.128)
local ClearBtn = button("CLEAR",0.235)

-- LOG TEMPLATE
local function newLog(server)
    local f = Instance.new("Frame")
    f.Size = UDim2.new(1,-10,0,55)
    f.BackgroundColor3 = Color3.fromRGB(199,31,0)
    Instance.new("UICorner", f)

    local name = Instance.new("TextLabel", f)
    name.Text = server.brainrot
    name.Size = UDim2.new(0.6,0,0.45,0)
    name.Position = UDim2.new(0.03,0,0.05,0)
    name.BackgroundTransparency = 1
    name.TextColor3 = Color3.new(1,1,1)
    name.TextSize = 17
    name.Font = Enum.Font.GothamBold

    local mps = Instance.new("TextLabel", f)
    mps.Text = "$"..server.mps.."/s"
    mps.Size = UDim2.new(0.6,0,0.35,0)
    mps.Position = UDim2.new(0.03,0,0.55,0)
    mps.BackgroundTransparency = 1
    mps.TextColor3 = Color3.new(1,1,1)
    mps.TextSize = 15
    mps.Font = Enum.Font.Gotham

    local join = Instance.new("TextButton", f)
    join.Text = "JOIN"
    join.Size = UDim2.new(0,68,0,40)
    join.Position = UDim2.new(0.62,0,0.15,0)
    join.BackgroundColor3 = Color3.fromRGB(199,31,0)
    join.TextColor3 = Color3.new(1,1,1)
    join.TextSize = 20
    join.Font = Enum.Font.GothamBold
    Instance.new("UICorner", join)

    join.MouseButton1Click:Connect(function()
        TeleportService:TeleportToPlaceInstance(
            server.placeId,
            server.jobId,
            Player
        )
    end)

    return f
end

-- LOGIC
local function clearLogs()
    for _,v in ipairs(logs:GetChildren()) do
        if v:IsA("Frame") then v:Destroy() end
    end
    logs.CanvasSize = UDim2.new()
end

local function fetchServers()
    local res = request({Url=SERVER_URL,Method="GET"})
    if not res or not res.Body then return end

    local data = HttpService:JSONDecode(res.Body)
    if type(data) ~= "table" then return end

    clearLogs()
    for _,server in ipairs(data) do
        if server.brainrot and server.jobId then
            local log = newLog(server)
            log.Parent = logs
        end
    end

    task.wait()
    logs.CanvasSize = UDim2.new(0,0,0,layout.AbsoluteContentSize.Y + 10)

    if AUTO_JOIN and data[1] then
        TeleportService:TeleportToPlaceInstance(
            data[1].placeId,
            data[1].jobId,
            Player
        )
    end
end

-- BUTTONS
RefreshBtn.MouseButton1Click:Connect(fetchServers)
ClearBtn.MouseButton1Click:Connect(clearLogs)
AutoBtn.MouseButton1Click:Connect(function()
    AUTO_JOIN = not AUTO_JOIN
    AutoBtn.Text = AUTO_JOIN and "AUTO JOIN: ON" or "AUTO JOIN"
end)

-- AUTO REFRESH
task.spawn(function()
    while true do
        task.wait(REFRESH_DELAY)
        fetchServers()
    end
end)

fetchServers()

local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")
local TeleportService = game:GetService("TeleportService")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer

local RELAY_URL = "https://YOUR_RELAY_URL/servers"
local PLACE_ID = game.PlaceId

local gui = Instance.new("ScreenGui")
gui.Name = "KrypthAJ"
gui.ResetOnSpawn = false
gui.Parent = player:WaitForChild("PlayerGui")

local main = Instance.new("Frame")
main.Size = UDim2.fromScale(0.38, 0.46)
main.Position = UDim2.fromScale(0.31, 0.27)
main.BackgroundColor3 = Color3.fromRGB(20, 20, 24)
main.BorderSizePixel = 0
main.Parent = gui

Instance.new("UICorner", main).CornerRadius = UDim.new(0, 14)
local stroke = Instance.new("UIStroke", main)
stroke.Thickness = 1.5
stroke.Color = Color3.fromRGB(80, 90, 120)

local title = Instance.new("TextLabel")
title.Size = UDim2.fromScale(1, 0.14)
title.BackgroundTransparency = 1
title.Text = "Krypth AJ"
title.Font = Enum.Font.GothamBold
title.TextSize = 26
title.TextColor3 = Color3.fromRGB(235, 235, 240)
title.Parent = main

local divider = Instance.new("Frame")
divider.Size = UDim2.fromScale(0.9, 0.003)
divider.Position = UDim2.fromScale(0.05, 0.16)
divider.BackgroundColor3 = Color3.fromRGB(70, 80, 110)
divider.BorderSizePixel = 0
divider.Parent = main

local body = Instance.new("Frame")
body.Size = UDim2.fromScale(0.9, 0.76)
body.Position = UDim2.fromScale(0.05, 0.2)
body.BackgroundTransparency = 1
body.Parent = main

local layout = Instance.new("UIListLayout", body)
layout.Padding = UDim.new(0, 12)

local function inputRow(text)
	local f = Instance.new("Frame")
	f.Size = UDim2.fromScale(1, 0.14)
	f.BackgroundColor3 = Color3.fromRGB(26, 26, 32)
	f.BorderSizePixel = 0
	Instance.new("UICorner", f).CornerRadius = UDim.new(0, 10)
	local s = Instance.new("UIStroke", f)
	s.Color = Color3.fromRGB(60, 70, 100)

	local l = Instance.new("TextLabel")
	l.Size = UDim2.fromScale(0.45, 1)
	l.BackgroundTransparency = 1
	l.Text = text
	l.Font = Enum.Font.GothamMedium
	l.TextSize = 15
	l.TextColor3 = Color3.fromRGB(200, 200, 210)
	l.Parent = f

	local b = Instance.new("TextBox")
	b.Size = UDim2.fromScale(0.5, 0.6)
	b.Position = UDim2.fromScale(0.47, 0.2)
	b.BackgroundColor3 = Color3.fromRGB(18, 18, 22)
	b.Font = Enum.Font.Gotham
	b.TextSize = 14
	b.TextColor3 = Color3.fromRGB(230, 230, 235)
	b.BorderSizePixel = 0
	b.ClearTextOnFocus = false
	Instance.new("UICorner", b).CornerRadius = UDim.new(0, 8)
	b.Parent = f

	return f, b
end

local mpsRow, minMps = inputRow("Min MPS")
mpsRow.Parent = body

local playersRow, maxPlayers = inputRow("Max Players")
playersRow.Parent = body

local logFrame = Instance.new("Frame")
logFrame.Size = UDim2.fromScale(1, 0.32)
logFrame.BackgroundColor3 = Color3.fromRGB(22, 22, 28)
logFrame.BorderSizePixel = 0
Instance.new("UICorner", logFrame).CornerRadius = UDim.new(0, 10)
Instance.new("UIStroke", logFrame).Color = Color3.fromRGB(60, 70, 100)
logFrame.Parent = body

local scroll = Instance.new("ScrollingFrame")
scroll.Size = UDim2.fromScale(1, 1)
scroll.CanvasSize = UDim2.new(0, 0, 0, 0)
scroll.ScrollBarImageTransparency = 1
scroll.BackgroundTransparency = 1
scroll.Parent = logFrame

local logLayout = Instance.new("UIListLayout", scroll)
logLayout.Padding = UDim.new(0, 6)

logLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
	scroll.CanvasSize = UDim2.new(0, 0, 0, logLayout.AbsoluteContentSize.Y + 6)
end)

local joinButton = Instance.new("TextButton")
joinButton.Size = UDim2.fromScale(1, 0.16)
joinButton.BackgroundColor3 = Color3.fromRGB(45, 60, 140)
joinButton.Text = "AUTO JOIN"
joinButton.Font = Enum.Font.GothamBold
joinButton.TextSize = 18
joinButton.TextColor3 = Color3.fromRGB(245, 245, 250)
joinButton.BorderSizePixel = 0
Instance.new("UICorner", joinButton).CornerRadius = UDim.new(0, 12)
Instance.new("UIStroke", joinButton).Color = Color3.fromRGB(90, 110, 200)
joinButton.Parent = body

local function addLog(text)
	local l = Instance.new("TextLabel")
	l.Size = UDim2.fromScale(1, 0)
	l.AutomaticSize = Enum.AutomaticSize.Y
	l.BackgroundTransparency = 1
	l.TextWrapped = true
	l.TextXAlignment = Enum.TextXAlignment.Left
	l.Text = text
	l.Font = Enum.Font.Gotham
	l.TextSize = 13
	l.TextColor3 = Color3.fromRGB(210, 210, 220)
	l.Parent = scroll
end

local function fetchServers()
	local ok, res = pcall(function()
		return HttpService:JSONDecode(game:HttpGet(RELAY_URL))
	end)
	if not ok then return {} end
	return res
end

joinButton.MouseButton1Click:Connect(function()
	for _, v in ipairs(scroll:GetChildren()) do
		if v:IsA("TextLabel") then v:Destroy() end
	end

	local min = tonumber(minMps.Text) or 0
	local maxP = tonumber(maxPlayers.Text) or math.huge

	local servers = fetchServers()
	table.sort(servers, function(a, b)
		return (a.mps or 0) > (b.mps or 0)
	end)

	for _, s in ipairs(servers) do
		if s.placeId == PLACE_ID and s.mps >= min and s.players <= maxP then
			addLog("MPS: "..s.mps.." | Players: "..s.players.."/"..s.maxPlayers)
			TeleportService:TeleportToPlaceInstance(PLACE_ID, s.jobId, player)
			break
		end
	end
end)

UserInputService.InputBegan:Connect(function(i, g)
	if g then return end
	if i.KeyCode == Enum.KeyCode.LeftControl then
		gui.Enabled = not gui.Enabled
	end
end)
